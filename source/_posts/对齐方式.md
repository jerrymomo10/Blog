title : C语言中Struct的对齐方式
tags: [C,对齐方式]
---
 - 为什么要对齐  加快存储器对的读写操作，由两次读写变为一次，不需要拼接。
 - 什么叫做对齐  地址的对齐，2字节对齐就是地址是2的倍数，4字节对齐是地址是4的倍数。
 - 对齐策略 short类型地址必须是2的倍数，int int* float double 的地址必须是4的倍数。
 - IA32指令要求，每个块的存储都是以16字节对齐方式来分配的，就是说地址的最低4位的为0。
 - 举例 `struct data{
 char a;
 int b;
 int64_t c;
 char d;}`
那么 data d;
d的地址一定是4的倍数。
a的地址为0 占一个字节
b的地址为4 占4个字节（为了保证int的地址是4的倍数）
c的地址为8 占8个字节
d的地址为16 占1个字节
 - 在上面的例子中若data d[3] 那么data[1]的地址为多少呢？
为了保证地址的连续和数据的对齐，在data的结构体中一定要进行尾部填充，char d后面是填充3个字节还是7个呢？答案是7。因为data[1]的地址为data[0]+sizeof(data)，如果填充3个的话，data为20个字节大小，data[1]中的c地址为28，不再是8的倍数，字节不再对齐，所以一定是填充7。
 - sizeof(data)为24。
